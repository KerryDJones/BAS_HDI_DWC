## Generated mta.yaml based on template version 0.4.0
## appName = dwc_btp_odata
## language=nodejs; multiTenant=false
## approuter=
_schema-version: '3.1'
ID: dwc_btp_odata
description: "A simple CAP project."
version: 1.0.0
parameters:
  enable-parallel-deployments: true

build-parameters:
  before-all:
    - builder: custom
      commands:
        - npm install --production
        - npx -p @sap/cds-dk cds build --production

modules:                                                 #Values are referenced between Modules section (Defined) and the Resources section (Technical descriptions).
 # --------------------- SERVER MODULE ------------------------
 - name: dwc_btp_odata-srv
 # ------------------------------------------------------------
    type: nodejs
    path: gen/srv
    requires:
      # Resources extracted from CAP configuration
      - name: dwc_btp_odata-db                            #Generic name for the Module DB. 
     #   properties: {}
      - name: dwc_hdi_container_service                   #Generic name for the User Provided Service that will perform work on the HDI Container.
    provides:
      - name: srv-api                                     # required by consumers of CAP services (e.g. approuter)
        properties:
          srv-url: '${default-url}'
      #  properties: {}
 # -------------------- SIDECAR MODULE ------------------------
 - name: dwc_btp_odata-db-deployer
 # ------------------------------------------------------------
    type: hdb
    path: gen/db
    parameters:
        buildpack: nodejs_buildpack
    requires:
        # 'hana' and 'xsuaa' resources extracted from CAP configuration
        - name: dwc_btp_odata-db                            #Generic name for the Module DB. 
        properties:
          TARGET_CONTAINER: ~{hdi-service-name}
      - name: dwc_hdi_container_service                    #Generic name for the User Provided Service that will perform work on the HDI Container.
        group: SERVICE_REPLACEMENTS
        properties:
          key: ServiceName_1
          service: ~{the-service-name}
  #    - name: cross-container-service-1
  #      group: SERVICE_REPLACEMENTS
  #      properties:
  #        key: ServiceName_2
  #        service: '~{the-service-name}'
  #  parameters:
  #    buildpack: nodejs_buildpack
resources:                                                #Values are referenced between Modules section (Defined) and the Resources section (Technical descriptions).
 # services extracted from CAP configuration
 # 'service-plan' can be configured via 'cds.requires.<name>.vcap.plan'
# ------------------------------------------------------------
  - name: dwc_btp_odata-db                               #Generic name for the Module DB. 
# ------------------------------------------------------------
    type: com.sap.xs.hdi-container
    parameters:
      config:
        database_id: ba68962f-df70-47c3-bb56-b7b7c6c4224f #Technical name of the Database Tennent of DWC
        schema: DWC_ODATA_CONTAINER                       #Technical name of the Schema name of the DWC HDI container we want to use. 
        service: hana                                     
        service-plan: hdi-shared
    properties:
      hdi-service-name: '${service-name}'
 # The user provided service created in BTP to be able to access the DWC space database user
# ------------------------------------------------------------
  - name: dwc_hdi_container_service                       #Generic name for the User Provided Service that will perform work on the HDI Container.
# ------------------------------------------------------------
    type: org.cloudfoundry.existing-service
    parameters:
      service-name: 'Appgyver_DWC_SPACE_NA#I826853'      #Technical name for the User Provides Service created in the BTP cockpit - Service Instance. It is the service that maps XS to the DWC database tennent. 
    properties:
      the-service-name: '${service-name}'
  - name: cross-container-service-1
    type: org.cloudfoundry.existing-service
    parameters:
      service-name: 'Appgyver_DWC_SPACE_NA#I826853'       #Technical name for the User Provides Service created in the BTP cockpit - Service Instance. It is the service that maps XS to the DWC database tennent. 
    properties:
      the-service-name: '${service-name}'

